# 16-bit ALU 系統概述與介面規格
## System Overview and Interface Specifications

[返回主目錄](../README.md) | [下一章：控制解碼單元](02_control_decoder.md)

---

## 1. 系統概述

### 1.1 設計目標
本文件定義一個16位元算術邏輯單元(ALU)的完整系統架構，該設計針對嵌入式處理器和微控制器應用進行優化。

### 1.2 關鍵規格
| 參數 | 規格 | 說明 |
|------|------|------|
| **資料寬度** | 16-bit | 處理16位元運算元 |
| **架構類型** | RISC | 精簡指令集設計理念 |
| **運算數量** | 16種 | 完整的算術邏輯運算集 |
| **目標頻率** | 100-200 MHz | 平衡性能與功耗 |
| **製程技術** | 65nm CMOS | 成熟製程，成本效益高 |
| **功耗目標** | < 50mW @ 100MHz | 適合電池供電應用 |
| **面積估算** | ~0.15 mm² | 緊湊設計 |

### 1.3 目標應用
- 嵌入式微控制器
- IoT感測器節點
- 工業控制器
- 智慧家電控制
- 電池供電裝置

---

## 2. 系統架構

### 2.1 頂層方塊圖

```
┌─────────────────────────────────────────────────────────────────┐
│                        16-bit ALU System                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌──────────────┐                      ┌──────────────────┐    │
│  │              │                      │                  │    │
│  │    Input     │   ┌──────────────┐   │     Output       │    │
│  │  Interface   ├──►│              ├──►│    Interface     │    │
│  │              │   │   ALU Core   │   │                  │    │
│  └──────────────┘   │              │   └──────────────────┘    │
│                     └──────────────┘                           │
│                            ▲                                   │
│                            │                                   │
│                     ┌──────────────┐                           │
│                     │   Control    │                           │
│                     │    Logic     │                           │
│                     └──────────────┘                           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 功能區塊劃分

| 功能區塊 | 主要功能 | 關聯文檔 |
|---------|---------|----------|
| **控制解碼單元** | OpCode解碼、控制信號產生 | [02_control_decoder.md](02_control_decoder.md) |
| **算術運算單元** | 加法、減法、遞增、遞減、比較 | [03_arithmetic_unit.md](03_arithmetic_unit.md) |
| **邏輯運算單元** | AND、OR、XOR、NOT、TEST | [04_logic_unit.md](04_logic_unit.md) |
| **移位運算單元** | LSL、LSR、ASR、ROL、ROR | [05_shift_unit.md](05_shift_unit.md) |
| **結果多工器** | 16路結果選擇 | [06_result_multiplexer.md](06_result_multiplexer.md) |
| **狀態旗標產生器** | Zero、Carry、Overflow、Negative | [07_flag_generator.md](07_flag_generator.md) |

---

## 3. 介面規格

### 3.1 輸入介面

| 信號名稱 | 位元寬度 | 方向 | 描述 | 時序要求 |
|----------|----------|------|------|----------|
| **A[15:0]** | 16 | Input | 運算元A | tSU = 1.5ns |
| **B[15:0]** | 16 | Input | 運算元B | tSU = 1.5ns |
| **OpCode[3:0]** | 4 | Input | 操作碼 | tSU = 1.0ns |
| **Cin** | 1 | Input | 進位輸入 | tSU = 1.5ns |
| **CLK** | 1 | Input | 時脈信號 | - |
| **RST_n** | 1 | Input | 異步重置(低電位有效) | - |
| **EN** | 1 | Input | 使能信號 | tSU = 0.8ns |

### 3.2 輸出介面

| 信號名稱 | 位元寬度 | 方向 | 描述 | 時序要求 |
|----------|----------|------|------|----------|
| **Result[15:0]** | 16 | Output | 運算結果 | tCO = 2.5ns |
| **Zero** | 1 | Output | 零旗標 (Result == 0) | tCO = 3.0ns |
| **Carry** | 1 | Output | 進位/借位旗標 | tCO = 2.0ns |
| **Overflow** | 1 | Output | 溢位旗標 | tCO = 2.5ns |
| **Negative** | 1 | Output | 負數旗標 (Result[15]) | tCO = 2.0ns |

### 3.3 介面時序圖

```
        ┌─┐   ┌─┐   ┌─┐   ┌─┐
CLK  ───┘ └───┘ └───┘ └───┘ └───
        
        ╱─────╲─────╱─────╲─────
A,B    ╱ Valid Data ╲ Next Data ╲
       ╲─────╱─────╲─────╱─────
       
              ╱─────────╲─────────
Result       ╱  Valid   ╲  Next
             ╲─────────╱─────────
       |←tSU→|←──tCO──→|
```

---

## 4. 操作模式

### 4.1 運算操作定義

| OpCode | 助記符 | 運算描述 | 運算公式 | 影響旗標 |
|--------|--------|----------|----------|----------|
| 0000 | ADD | 加法 | Result = A + B + Cin | Z,C,V,N |
| 0001 | SUB | 減法 | Result = A - B - Cin | Z,C,V,N |
| 0010 | AND | 邏輯AND | Result = A & B | Z,N |
| 0011 | OR | 邏輯OR | Result = A \| B | Z,N |
| 0100 | XOR | 邏輯XOR | Result = A ^ B | Z,N |
| 0101 | NOT | 邏輯NOT | Result = ~A | Z,N |
| 0110 | LSL | 邏輯左移 | Result = A << 1 | Z,C,N |
| 0111 | LSR | 邏輯右移 | Result = A >> 1 | Z,C,N |
| 1000 | ASR | 算術右移 | Result = A >>> 1 | Z,C,N |
| 1001 | ROL | 循環左移 | Result = ROL(A) | Z,C,N |
| 1010 | ROR | 循環右移 | Result = ROR(A) | Z,C,N |
| 1011 | INC | 遞增 | Result = A + 1 | Z,C,V,N |
| 1100 | DEC | 遞減 | Result = A - 1 | Z,C,V,N |
| 1101 | CMP | 比較 | A - B (只設定旗標) | Z,C,V,N |
| 1110 | TEST | 測試 | A & B (只設定旗標) | Z,N |
| 1111 | PASS | 直通 | Result = A | Z,N |

### 4.2 旗標定義

| 旗標 | 名稱 | 設定條件 |
|------|------|----------|
| **Z (Zero)** | 零旗標 | Result[15:0] == 16'h0000 |
| **C (Carry)** | 進位旗標 | 算術運算產生進位或移位運算移出位元 |
| **V (Overflow)** | 溢位旗標 | 有符號算術運算溢位 |
| **N (Negative)** | 負數旗標 | Result[15] == 1 (最高位元為1) |

---

## 5. 電氣特性

### 5.1 絕對最大額定值

| 參數 | 符號 | 最小值 | 最大值 | 單位 |
|------|------|--------|--------|------|
| 電源電壓 | VDD | -0.5 | 1.5 | V |
| 輸入電壓 | VIN | -0.5 | VDD+0.5 | V |
| 工作溫度 | TOP | -40 | 125 | °C |
| 儲存溫度 | TSTG | -65 | 150 | °C |

### 5.2 推薦工作條件

| 參數 | 符號 | 最小值 | 典型值 | 最大值 | 單位 |
|------|------|--------|--------|--------|------|
| 電源電壓 | VDD | 1.08 | 1.2 | 1.32 | V |
| 工作溫度 | TOP | -25 | 25 | 85 | °C |
| 時脈頻率 | fCLK | 1 | 100 | 200 | MHz |

---

## 6. 系統整合

### 6.1 典型應用電路

```verilog
// Verilog實例化範例
ALU_16bit u_alu (
    .CLK      (sys_clk),
    .RST_n    (sys_rst_n),
    .EN       (alu_enable),
    .A        (reg_a),
    .B        (reg_b),
    .OpCode   (instruction[3:0]),
    .Cin      (carry_in),
    .Result   (alu_result),
    .Zero     (flag_z),
    .Carry    (flag_c),
    .Overflow (flag_v),
    .Negative (flag_n)
);
```

### 6.2 處理器整合架構

```
┌────────────┐      ┌─────────┐      ┌────────────┐
│  Register  │─────►│   ALU   │─────►│  Register  │
│   File A   │      │  16-bit │      │   File B   │
└────────────┘      └─────────┘      └────────────┘
                          ▲
                          │
                    ┌─────────┐
                    │ Control │
                    │  Unit   │
                    └─────────┘
```

---

## 7. 設計層次

### 7.1 抽象層級定義

| 層級 | 名稱 | 描述 | 相關方塊圖 |
|------|------|------|-----------|
| **L1** | 系統層 | 完整ALU功能單元 | [系統級方塊圖](block_diagram/system_level/alu_top_level.md) |
| **L2** | 功能層 | 運算核心、狀態產生器、控制單元 | [模組級方塊圖](block_diagram/module_level/) |
| **L3** | 模組層 | 加法器、邏輯單元、移位器、多工器 | [邏輯閘級電路](block_diagram/gate_level/) |
| **L4** | 單元層 | 全加器、邏輯閘、移位單元 | [邏輯閘級電路](block_diagram/gate_level/) |
| **L5** | 電晶體層 | CMOS電晶體實現 | [電晶體級電路](block_diagram/transistor_level/) |

### 7.2 設計流程

```
規格定義 → 架構設計 → RTL編碼 → 功能驗證 → 綜合 → 
物理設計 → 時序驗證 → 製造
```

---

## 8. 關鍵性能指標

### 8.1 性能摘要

| 指標 | 數值 | 說明 |
|------|------|------|
| **最大頻率** | 147 MHz | 基於關鍵路徑6.8ns |
| **功耗效率** | 0.26 mW/MHz | 動態功耗/頻率 |
| **面積效率** | 0.0009 mm²/bit | 總面積/位元寬度 |
| **電晶體密度** | 22,000 個/mm² | 總電晶體數/面積 |
| **能量延遲乘積** | 357 fJ | 功耗×延遲 |

### 8.2 與業界比較

| 比較項目 | 本設計 | 業界標準 | 先進設計 | 競爭力 |
|---------|-------|---------|---------|--------|
| 功耗/頻率 | 0.26 mW/MHz | 0.35 mW/MHz | 0.20 mW/MHz | 良好 |
| 面積/位元 | 0.009 mm²/bit | 0.012 mm²/bit | 0.007 mm²/bit | 優秀 |
| 最大頻率 | 147 MHz | 120 MHz | 200 MHz | 良好 |
| 運算完整性 | 16種運算 | 12種運算 | 20種運算 | 優秀 |

---

## 9. 相關文檔

### 9.1 詳細設計文檔
- [控制解碼單元](02_control_decoder.md)
- [算術運算單元](03_arithmetic_unit.md)
- [邏輯運算單元](04_logic_unit.md)
- [移位運算單元](05_shift_unit.md)
- [結果多工器](06_result_multiplexer.md)
- [狀態旗標產生器](07_flag_generator.md)

### 9.2 分析文檔
- [關鍵路徑分析](08_critical_path_analysis.md)
- [功耗與面積分析](09_power_area_analysis.md)
- [優化策略](10_optimization_strategy.md)

### 9.3 方塊圖索引
- [系統級方塊圖](block_diagram/system_level/)
- [模組級方塊圖](block_diagram/module_level/)
- [邏輯閘級電路圖](block_diagram/gate_level/)
- [電晶體級電路圖](block_diagram/transistor_level/)

---

## 10. 版本歷史

| 版本 | 日期 | 作者 | 變更描述 |
|------|------|------|----------|
| 1.0 | 2024-01-19 | System | 初始文檔創建 |

---

**下一章**：[控制解碼單元詳細分析](02_control_decoder.md)